(()=>{var u=(t=window.location.pathname,e=!1)=>{let n=t.split("/").filter(r=>(r=r.trim(),r.length>0&&r!=="/"&&r!=="index.html"));return e?n[0]||"/":n[n.length-1]||"/"},p=t=>new Promise(e=>{"onscrollend"in window?(document.addEventListener("scrollend",e,{once:!0}),t.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})):(t.scrollIntoView({block:"center",inline:"center"}),e())});_$$(".article-entry h1>a, .article-entry h2>a, .article-entry h3>a, .article-entry h4>a, .article-entry h5>a, .article-entry h6>a").forEach(t=>{window.siteConfig.icon_font?t.innerHTML=window.siteConfig.anchor_icon?`&#x${window.siteConfig.anchor_icon};`:"&#xe635;":t.innerHTML=window.siteConfig.anchor_icon?`&#x${window.siteConfig.anchor_icon};`:"&#xf292;"});_$$(".article-entry img").forEach(t=>{if(t.parentElement?.classList.contains("friend-icon")||t.parentElement?.tagName==="A"||t.classList.contains("no-lightbox"))return;let e=document.createElement("a");e.href?e.href=t.src:e.setAttribute("href",t.src),e.dataset.pswpWidth=t.naturalWidth,e.dataset.pswpHeight=t.naturalHeight,e.target="_blank",e.classList.add("article-gallery-item"),t.parentNode?.insertBefore(e,t),t.parentNode?.removeChild(t),e.appendChild(t)});window.lightboxStatus="ready";window.dispatchEvent(new Event("lightbox:ready"));var c=!1;_$("#main-nav-toggle")?.off("click").on("click",()=>{c||(c=!0,document.body.classList.toggle("mobile-nav-on"),_$("#mask").classList.remove("hide"),setTimeout(()=>{c=!1},300))});_$("#mask")?.off("click").on("click",()=>{c||!document.body.classList.contains("mobile-nav-on")||(document.body.classList.remove("mobile-nav-on"),_$("#mask").classList.add("hide"))});_$$(".sidebar-toc-btn").forEach(t=>{t.off("click").on("click",function(){this.classList.contains("current")||(_$$(".sidebar-toc-btn").forEach(e=>e.classList.add("current")),_$$(".sidebar-common-btn").forEach(e=>e.classList.remove("current")),_$$(".sidebar-toc-sidebar").forEach(e=>e.classList.remove("hidden")),_$$(".sidebar-common-sidebar").forEach(e=>e.classList.add("hidden")))})});_$$(".sidebar-common-btn").forEach(t=>{t.off("click").on("click",function(){this.classList.contains("current")||(_$$(".sidebar-common-btn").forEach(e=>e.classList.add("current")),_$$(".sidebar-toc-btn").forEach(e=>e.classList.remove("current")),_$$(".sidebar-common-sidebar").forEach(e=>e.classList.remove("hidden")),_$$(".sidebar-toc-sidebar").forEach(e=>e.classList.add("hidden")))})});(()=>{let t=u(window.location.pathname);_$$(".sidebar-menu-link-wrap").forEach(e=>{let n=e.querySelector("a")?.getAttribute("href");n&&u(n)===t&&e.classList.add("link-active")})})();_$$(".article-entry img").forEach(t=>{t.classList.contains("lazyload")||(t.classList.add("lazyload"),t.setAttribute("data-src",t.src),t.setAttribute("data-sizes","auto"),t.removeAttribute("src"))});var l=_$(".sidebar-top");l&&(l.style.transition="opacity 1s",l.off("click").on("click",()=>{window.scrollTo({top:0,behavior:"smooth"})}),document.documentElement.scrollTop<10&&(l.style.opacity="0"));var d;d&&window.off("scroll",d);d=()=>{let t=_$(".sidebar-top");document.documentElement.scrollTop<10?t.style.opacity="0":t.style.opacity="1"};window.on("scroll",d);_$$("#TableOfContents li").forEach(t=>{t.off("click").on("click",()=>{c||!document.body.classList.contains("mobile-nav-on")||(document.body.classList.remove("mobile-nav-on"),_$("#mask").classList.add("hide"))})});_$$(".sidebar-menu-link-dummy").forEach(t=>{t.off("click").on("click",()=>{c||!document.body.classList.contains("mobile-nav-on")||setTimeout(()=>{document.body.classList.remove("mobile-nav-on"),_$("#mask").classList.add("hide")},200)})});function $(){if(!_$("#sidebar"))return;let t=getComputedStyle(_$("#sidebar")).display==="block"?_$$("#sidebar .sidebar-toc-wrapper li"):_$$("#mobile-nav .sidebar-toc-wrapper li");if(!t.length)return;let e=null,n=(i,o)=>{i.preventDefault();let a=_$(decodeURI(i.currentTarget.getAttribute("href")));e=o,p(a).then(()=>{h(o),e=null})},r=[...t].map((i,o)=>{let a=i.querySelector("a");a.off("click").on("click",f=>n(f,o));let s=_$(decodeURI(a.getAttribute("href")));return s?(s.querySelector("a")?.off("click").on("click",f=>n(f,o)),s):null}),h=i=>{let o=t[i];if(!o||o.classList.contains("current"))return;_$$(".sidebar-toc-wrapper .active").forEach(s=>{s.classList.remove("active","current")}),r.forEach(s=>{s?.classList.remove("active")}),o.classList.add("active","current"),r[i]?.classList.add("active");let a=o.parentNode;for(;!a.matches(".sidebar-toc");){if(a.matches("li")){a.classList.add("active");let s=_$(decodeURI(a.querySelector("a").getAttribute("href")));s&&s.classList.add("active")}a=a.parentNode}if(_$(".sidebar-toc-sidebar").classList.contains("hidden")){let s=_$(".sidebar-toc-wrapper");s.scrollTo({top:s.scrollTop+o.offsetTop-s.offsetHeight/2,behavior:"smooth"})}},b=i=>{let o=0,a=i[o];if(a.boundingClientRect.top>0)return o=r.indexOf(a.target),o===0?0:o-1;for(;o<i.length;o++)if(i[o].boundingClientRect.top<=0)a=i[o];else return r.indexOf(a.target);return r.indexOf(a.target)},m=new IntersectionObserver(i=>{let o=b(i)+(window.diffY>0?1:0);e===null&&h(o)},{rootMargin:"0px 0px -100% 0px",threshold:0});r.forEach(i=>{i&&m.observe(i)})}$();_$(".sponsor-button-wrapper")?.off("click").on("click",()=>{_$(".sponsor-button-wrapper")?.classList.toggle("active"),_$(".sponsor-tip")?.classList.toggle("active"),_$(".sponsor-qr")?.classList.toggle("active")});})();
